# File Server Analysis

# Needed Module
# install-module NTFSsecurity
# install-module PSFolder Size 

$homeroot = "\\srvfs5\g$\HOME"

$home_folder_path = get-childitem -Path $homeroot


$home_folder_path | foreach{
                            
                            $fullpath = $_.fullname
                            $name = $_.Name
                            $folder_size = try{Get-FolderSize -FolderName $name -BasePath $fullpath -ErrorAction Stop | select-object -ExpandProperty 'Size(GB)'}catch{$folder_size = "No Access"}
                            if($folder_size -eq $null){$folder_size = "0"}
                            $owner = (Get-NTFSOwner -Path $fullpath).owner
                            $right = Get-NTFSAccess -Path $fullpath

                            $last_modification = $_.LastWriteTime

                            [pscustomobject]@{
                                              
                                              Name = $name
                                              Fullpath = $fullpath
                                              Modification = $last_modification
                                              'Size(GB)' = $folder_size
                                              Owner = $owner
                                              NTFS = $right
                                             
                                             }

